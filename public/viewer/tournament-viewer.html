<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒˆãƒ¼ãƒŠãƒ¡ãƒ³ãƒˆè¡¨</title>
    <link rel="icon" href="../icons/favicon.ico">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Kosugi+Maru&family=Zen+Kaku+Gothic+New:wght@500;700;900&display=swap"
        rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        rel="stylesheet" />

    <style>
        /* --- ãƒ†ãƒ¼ãƒå®šç¾© --- */
        :root {
            --color-main: #1F2937;
            --color-bg: #F3F4F6;
            --color-panel: #FFFFFF;
            --color-shadow: #D1D5DB;
            
            --color-live-bg: #EF4444;
            --color-live-inactive: #9CA3AF;
            --color-live-text: #FFFFFF;
            
            /* Match Colors */
            --color-alpha: #d0be08;
            --color-bravo: #3a0ccd;
            --color-win-bg: #FEF3C7;
        }

        body {
            font-family: 'Zen Kaku Gothic New', 'Kosugi Maru', sans-serif;
            background-color: var(--color-bg);
            color: var(--color-main);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* --- ãƒ˜ãƒƒãƒ€ãƒ¼ --- */
        .viewer-header {
            background-color: #FFFFFF;
            border-bottom: 3px solid var(--color-main);
            padding: 1rem; /* é«˜ã•ã‚’æŠ‘ãˆã‚‹ */
            text-align: center;
            z-index: 50;
            flex-shrink: 0;
        }

        .tournament-title {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--color-main);
            line-height: 1;
            letter-spacing: -0.02em;
        }
        @media (min-width: 768px) { .tournament-title { font-size: 2rem; } }

        .tournament-subtitle {
            font-size: 0.7rem;
            font-weight: 800;
            color: #6B7280;
            letter-spacing: 0.15em;
            margin-top: 0.2rem;
            text-transform: uppercase;
        }

        /* --- ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢ --- */
        .main-container {
            flex: 1;
            width: 100%;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* --- ãƒˆãƒ¼ãƒŠãƒ¡ãƒ³ãƒˆè¡¨ --- */
        .bracket-container {
            flex: 1;
            overflow: auto;
            padding: 1.5rem; /* ä½™ç™½å¾®èª¿æ•´ */
            background-color: transparent; 
            scrollbar-width: thin;
            scrollbar-color: var(--color-main) #E5E7EB;
            cursor: grab;
            user-select: none;
            display: flex;
            justify-content: flex-start; 
            align-items: flex-start;
        }
        .bracket-container::before, .bracket-container::after { content: ''; margin: auto; }
        .bracket-container.active { cursor: grabbing; }

        .bracket-wrapper {
            display: flex; gap: 3rem; /* ã‚®ãƒ£ãƒƒãƒ—ç¸®å° */
            min-width: max-content; padding-bottom: 2rem;
        }

        .round-column {
            display: flex; flex-direction: column; justify-content: space-around;
            gap: 1.5rem; /* ã‚«ãƒ¼ãƒ‰é–“éš”ç¸®å° */
            width: 360px; flex-shrink: 0;
        }

        .round-header {
            text-align: center; padding-bottom: 0.5rem; border-bottom: 3px dashed var(--color-shadow);
            margin-bottom: 0.75rem; font-weight: 900; font-size: 1.1rem; color: var(--color-main);
            position: sticky; top: 0; z-index: 10; background-color: var(--color-bg); letter-spacing: 0.05em;
        }

        /* --- ãƒãƒƒãƒã‚«ãƒ¼ãƒ‰ (Compact) --- */
        .match-card {
            background-color: #FFFFFF;
            border: 2px solid var(--color-main);
            border-radius: 0.75rem;
            box-shadow: 4px 4px 0 0 var(--color-shadow);
            padding: 0.75rem; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ç¸®å° */
            display: flex; flex-direction: column; gap: 0.5rem; /* å†…éƒ¨ã‚®ãƒ£ãƒƒãƒ—ç¸®å° */
            position: relative; margin: 0.25rem 0;
            transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .match-card:hover { transform: translate(2px, 2px); box-shadow: 2px 2px 0 0 var(--color-shadow); z-index: 10; }

        .match-card.is-live { background-color: #FFFFFF; z-index: 20; }
        .match-card.is-live.status-active {
            border-color: var(--color-live-bg);
            box-shadow: 6px 6px 0 0 rgba(239, 68, 68, 0.2);
            animation: pulse-border 2s infinite;
        }
        .match-card.is-live.status-inactive {
            border-color: var(--color-live-inactive);
            box-shadow: 4px 4px 0 0 rgba(107, 114, 128, 0.2);
        }
        
        @keyframes pulse-border {
            0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            70% { box-shadow: 0 0 0 8px rgba(239, 68, 68, 0); }
            100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        .match-header { display: flex; justify-content: space-between; align-items: center; height: 20px; }
        .header-left-group { display: flex; gap: 6px; align-items: center; }

        .match-id {
            background: var(--color-main); color: white; font-size: 0.7rem; padding: 1px 6px; border-radius: 4px; font-weight: 800;
        }
        .match-card.is-live.status-active .match-id { background: var(--color-live-bg); }
        .match-card.is-live.status-inactive .match-id { background: #6B7280; }

        .bo-badge {
            background: #F3F4F6; color: var(--color-main); font-size: 0.7rem; padding: 1px 6px;
            border-radius: 4px; font-weight: 800; border: 2px solid #E5E7EB;
        }

        .live-badge {
            font-size: 0.7rem; font-weight: 900; padding: 1px 8px; border-radius: 9999px;
            display: flex; align-items: center; gap: 3px; color: white; border: 2px solid transparent;
        }
        .match-card.is-live.status-active .live-badge { background-color: var(--color-live-bg); border-color: var(--color-live-bg); }
        .match-card.is-live.status-inactive .live-badge { background-color: var(--color-live-inactive); border-color: var(--color-live-inactive); }

        /* ãƒãƒ¼ãƒ è¡Œ (Compact) */
        .team-row {
            display: flex; align-items: center; gap: 0.5rem; padding: 0.4rem;
            border-radius: 0.5rem; background-color: #F9FAFB; border: 2px solid transparent;
            overflow: hidden; transition: all 0.2s;
        }
        .team-row.winner { background-color: #FEF3C7; border-color: #FCD34D; }
        .team-row.winner .team-name-display { color: #000; font-weight: 900; }
        .team-row.loser { opacity: 0.5; background-color: #FFFFFF; border-color: #F3F4F6; }

        .team-label { width: 5px; height: 24px; border-radius: 2.5px; flex-shrink: 0; border: 1px solid rgba(0,0,0,0.1); }
        .label-alpha { background-color: var(--color-alpha); }
        .label-bravo { background-color: var(--color-bravo); }

        .team-info-area { flex: 1; min-width: 0; display: flex; align-items: center; }
        
        .team-name-display {
            width: 100%; font-size: 0.95rem; font-weight: 700; line-height: 1.2;
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
            color: var(--color-main); cursor: pointer; transition: color 0.1s;
        }
        .team-name-display:hover { color: #2563EB; text-decoration: underline; }
        .text-undecided { color: #D1D5DB; font-weight: 600; cursor: default; }
        .text-undecided:hover { color: #D1D5DB; text-decoration: none; }

        .score-display {
            font-size: 1.25rem; font-weight: 900; width: 1.75rem; text-align: center;
            color: #9CA3AF; flex-shrink: 0; line-height: 1;
        }
        .match-card.is-live .score-display { color: var(--color-main); }
        
        .win-mark { width: 20px; display: flex; justify-content: center; color: #F59E0B; opacity: 0; flex-shrink: 0; }
        .team-row.winner .win-mark { opacity: 1; }

        .match-card::after {
            content: 'arrow_forward'; font-family: 'Material Symbols Rounded';
            position: absolute; right: -32px; top: 50%; transform: translateY(-50%); 
            color: #D1D5DB; font-weight: 900; font-size: 1.5rem; display: none; pointer-events: none;
        }
        .round-column:not(:last-child) .match-card::after { display: block; }
        
        .loading-state {
            display: flex; justify-content: center; align-items: center; height: 300px; 
            color: #9CA3AF; font-weight: 700; font-size: 1.2rem; width: 100%;
        }

        /* --- ãƒ¢ãƒ¼ãƒ€ãƒ« (Compact Brutalist) --- */
        .modal-overlay {
            position: fixed; inset: 0; background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(4px); display: flex; align-items: center; justify-content: center;
            z-index: 100; opacity: 0; pointer-events: none; transition: opacity 0.2s;
        }
        .modal-overlay.show { opacity: 1; pointer-events: auto; }
        
        .modal-content {
            background: white; width: 90%; max-width: 550px; max-height: 85vh;
            border-radius: 1.25rem; overflow-y: auto;
            border: 3px solid var(--color-main);
            box-shadow: 8px 8px 0 0 var(--color-shadow); /* å½±ã‚‚å°‘ã—å°ã•ã */
            transform: scale(0.95); transition: transform 0.2s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex; flex-direction: column;
        }
        .modal-overlay.show .modal-content { transform: scale(1); }

        .modal-header {
            padding: 1.5rem 1.5rem 1rem 1.5rem; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°å‰Šæ¸› */
            border-bottom: 2px solid #E5E7EB;
            background: #FFFFFF; position: sticky; top: 0; z-index: 10;
        }
        .modal-body { padding: 1.5rem; display: flex; flex-direction: column; gap: 1.25rem; }

        .modal-label { 
            font-size: 0.7rem; font-weight: 900; color: #9CA3AF; 
            margin-bottom: 0.25rem; letter-spacing: 0.1em; text-transform: uppercase; display: block;
        }
        
        .modal-text { font-size: 0.95rem; color: #374151; line-height: 1.6; white-space: pre-wrap; font-weight: 500; }
        
        /* ãƒ¡ãƒ³ãƒãƒ¼ãƒªã‚¹ãƒˆ */
        .member-list-item {
            padding: 0.75rem; border: 2px solid #E5E7EB; border-radius: 0.5rem;
            margin-bottom: 0.5rem; background: #FFFFFF; transition: all 0.2s;
        }
        .member-list-item:hover { border-color: var(--color-main); transform: translate(2px, 2px); }

        .member-name-row { display: flex; align-items: baseline; gap: 0.5rem; flex-wrap: wrap; line-height: 1; margin-bottom: 0.25rem; }
        .member-name { font-weight: 800; font-size: 1.05rem; color: #1F2937; }
        .member-kana { font-size: 0.7rem; font-weight: 700; color: #9CA3AF; }

        .weapon-container { display: flex; flex-wrap: wrap; gap: 0.4rem; }
        .weapon-tag {
            font-size: 0.7rem; font-weight: 700; color: #4B5563;
            background-color: #F3F4F6; border: 1px solid #D1D5DB;
            padding: 0.1rem 0.4rem; border-radius: 0.25rem;
        }

        .xp-badge {
            display: inline-flex; align-items: center; justify-content: center;
            background: var(--color-main); color: white;
            padding: 0.2rem 0.6rem; border-radius: 9999px; 
            font-weight: 900; font-size: 0.9rem; letter-spacing: 0.05em;
            box-shadow: 2px 2px 0 0 rgba(0,0,0,0.2);
        }

        /* ã‚µãƒ¼ã‚¯ãƒ«ã‚¿ã‚° */
        .circle-tag-container {
            display: inline-flex; align-items: stretch; 
            cursor: default; transition: transform 0.1s; user-select: none;
        }
        .circle-tag-container.has-link { cursor: pointer; }
        .circle-tag-container.has-link:hover { transform: translateY(-2px); }
        .circle-tag-container.has-link:active { transform: translateY(0); }

        .circle-tag-main {
            background-color: var(--color-main); color: white;
            padding: 0.2rem 0.6rem; border: 2px solid var(--color-main);
            font-weight: 900; font-size: 0.8rem; letter-spacing: 0.05em;
            display: flex; align-items: center; gap: 0.4rem;
        }
        .circle-tag-icon {
            background-color: white; color: var(--color-main);
            border: 2px solid var(--color-main); border-left: none;
            padding: 0 0.4rem; display: flex; align-items: center; justify-content: center;
            transition: background-color 0.2s;
        }
        .circle-tag-container:hover .circle-tag-icon { background-color: #F3F4F6; }

        .hidden { display: none !important; }

    </style>
</head>

<body>

    <header class="viewer-header">
        <h1 id="header-title" class="tournament-title">å¤§ä¼šæƒ…å ±èª­ã¿è¾¼ã¿ä¸­...</h1>
        <p class="tournament-subtitle">TOURNAMENT BRACKET</p>
    </header>

    <main class="main-container">
        <div class="bracket-container">
            <div id="bracket-wrapper" class="bracket-wrapper">
                <div class="loading-state">
                    Loading tournament data...
                </div>
            </div>
        </div>
    </main>

    <div id="team-modal" class="modal-overlay" onclick="closeTeamModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <div class="modal-header">
                <div class="flex justify-between items-start">
                    <div class="w-full">
                        <div class="mb-2">
                            <p id="m-univ" class="text-lg md:text-xl font-black text-gray-600 tracking-tight leading-none mb-2">UNIVERSITY</p>
                            
                            <div id="m-circle-container" class="circle-tag-container group">
                                <div class="circle-tag-main">
                                    <span class="material-symbols-rounded text-sm">diversity_3</span>
                                    <span id="m-circle">CIRCLE NAME</span>
                                </div>
                                <div id="m-circle-indicator" class="circle-tag-icon hidden">
                                    <span class="material-symbols-rounded text-sm">arrow_outward</span>
                                </div>
                            </div>
                        </div>

                        <div class="mb-2">
                            <p id="m-name-kana" class="text-xs font-bold text-gray-400 tracking-widest mb-0 leading-none"></p>
                            <h2 id="m-name" class="text-2xl md:text-3xl font-black text-gray-900 leading-tight">Team Name</h2>
                        </div>
                        
                        <div class="flex items-center gap-2">
                            <span id="m-xp" class="xp-badge">å¹³å‡XP ----</span>
                        </div>
                    </div>
                    <button onclick="closeTeamModal()" class="flex-shrink-0 p-1 hover:bg-gray-100 rounded-full text-gray-400 transition-colors">
                        <span class="material-symbols-rounded" style="font-size: 28px;">close</span>
                    </button>
                </div>
            </div>
            
            <div class="modal-body">
                <div>
                    <span class="modal-label">æ„æ°—è¾¼ã¿</span>
                    <div class="p-3 bg-gray-50 rounded-lg border-2 border-gray-100">
                        <p id="m-comment" class="modal-text">ã‚³ãƒ¡ãƒ³ãƒˆ</p>
                    </div>
                </div>

                <div>
                    <span class="modal-label">å®Ÿç¸¾</span>
                    <p id="m-records" class="modal-text text-sm text-gray-500 font-bold border-l-4 border-gray-300 pl-3">å®Ÿç¸¾ãªã—</p>
                </div>

                <div>
                    <span class="modal-label">ãƒ¡ãƒ³ãƒãƒ¼</span>
                    <div id="m-members"></div>
                </div>

                <div class="bg-yellow-50 p-4 rounded-lg border-2 border-yellow-200 shadow-[4px_4px_0_0_#FEF08A]">
                    <span class="modal-label !text-yellow-600 !mb-1">å¿œæ´ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</span>
                    <p id="m-message" class="modal-text text-yellow-900 font-bold">ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</p>
                </div>
            </div>
        </div>
    </div>

    <div id="circle-modal" class="modal-overlay" onclick="closeCircleModal(event)">
        <div class="modal-content bg-white" onclick="event.stopPropagation()">
            <div class="p-4 border-b-2 border-gray-100 flex justify-between items-center bg-gray-50">
                <h3 class="font-black text-lg text-gray-800 flex items-center gap-2">
                    <span class="material-symbols-rounded text-blue-600">diversity_3</span> CIRCLE INFO
                </h3>
                <button onclick="closeCircleModal()" class="p-1 hover:bg-gray-200 rounded-full text-gray-400 transition-colors">
                    <span class="material-symbols-rounded" style="font-size: 24px;">close</span>
                </button>
            </div>
            <div class="p-6 overflow-y-auto bg-white">
                <div class="flex flex-col items-center text-center mb-6">
                    <div class="w-24 h-24 rounded-full overflow-hidden border-4 border-gray-900 shadow-md mb-3 bg-gray-200">
                        <img id="modal-c-img" src="" alt="ã‚µãƒ¼ã‚¯ãƒ«ã‚¢ã‚¤ã‚³ãƒ³" class="w-full h-full object-cover"
                            onerror="this.src='data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' fill=\'%239ca3af\' viewBox=\'0 0 24 24\'%3e%3cpath d=\'M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z\'/%3e%3c/svg%3e'">
                    </div>
                    <p id="modal-c-univ" class="text-xs font-bold text-gray-500 mb-1 uppercase tracking-widest">UNIVERSITY</p>
                    <h2 id="modal-c-name" class="text-2xl font-black text-gray-900 mb-3">Circle Name</h2>
                    
                    <div class="flex flex-wrap justify-center gap-2 mb-2">
                        <a id="modal-c-id" href="#" target="_blank" rel="noopener noreferrer"
                           class="inline-flex items-center px-3 py-1 rounded-md bg-blue-50 text-blue-700 text-xs font-bold border border-blue-200 hover:bg-blue-100 hover:border-blue-300 transition-all active:translate-y-[1px]">
                           </a>
                        <span id="modal-c-win" class="inline-flex items-center px-3 py-1 rounded-md bg-orange-50 text-orange-700 text-xs font-bold border border-orange-200"></span>
                    </div>
                </div>
                <div class="bg-gray-50 rounded-lg p-4 border-2 border-gray-100">
                    <p id="modal-c-comment" class="text-gray-700 leading-relaxed whitespace-pre-wrap font-bold text-sm"></p>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getFirestore, doc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

        // --- DATA CONSTANTS ---
        const CIRCLE_DATA = [
            {
                "circle-university": "æ¨ªæµœå›½ç«‹å¤§å­¦", "circle-name": "æµœã‚¤ã‚«",
                "circle-social-img": "https://pbs.twimg.com/profile_images/1459543611629256704/tlF19GrW_400x400.jpg",
                "circle-social-id": "hama_ika4559", "circle-social-win": "æµœã‚¤ã‚«WIN",
                "circle-comment": "ã‚¹ãƒ—ãƒ©ãƒˆã‚¥ãƒ¼ãƒ³ã®ä¼ç”»ã ã‘ã§ãªãBBQç­‰ã®å¯¾é¢ä¼ç”»ã‚‚å®šæœŸçš„ã«é–‹å‚¬ã—ã¤ã¤ã€å­¦éƒ¨ç”Ÿã‹ã‚‰é™¢ç”Ÿã€ã‚¨ãƒ³ã‚¸ãƒ§ã‚¤å‹¢ã‹ã‚‰ã‚¬ãƒå‹¢ã¾ã§ã€ã¿ã‚“ãªå’Œæ°—ã‚ã„ã‚ã„ã¨æ´»å‹•ã—ã¦ã„ã¾ã™ï¼ï¼"
            },
            {
                "circle-university": "ç«‹å‘½é¤¨å¤§å­¦", "circle-name": "ãƒªãƒ„ãƒ¡ã‚¤ã‚«",
                "circle-social-img": "https://pbs.twimg.com/profile_images/1797446711532818432/Fr3fFT_5_400x400.jpg",
                "circle-social-id": "RitsumeIKA_lab", "circle-social-win": "ãƒªãƒ„ãƒ¡ã‚¤ã‚«WIN",
                "circle-comment": "ã‚¬ãƒå‹¢ã‚‚ã‚¨ãƒ³ã‚¸ãƒ§ã‚¤å‹¢ã‚‚ã¿ã‚“ãªä»²è‰¯ã—ã»ã®ã¼ã®å¹³å’Œãªãƒªãƒ„ãƒ¡ã‚¤ã‚«ã§ã™ï¼ä»Šå¹´ã¯è‰²ã€…ãªå¤§å­¦ã•ã‚“ã¨äº¤æµæˆ¦ã‚’ã—ãŸã„ãªã¨æ€ã£ã¦ã¾ã™ğŸ¦‘"
            },
            {
                "circle-university": "å¤§é˜ªå…¬ç«‹å¤§å­¦", "circle-name": "OMUã‚¹ãƒ—ãƒ©éƒ¨",
                "circle-social-img": "https://pbs.twimg.com/profile_images/1907480475419176960/zJ5eAz4O_400x400.jpg",
                "circle-social-id": "hamu_splatoon3", "circle-social-win": "ãƒãƒ å¤§ã‚¹ãƒ—ãƒ©éƒ¨WIN",
                "circle-comment": "å¹…åºƒã„ãƒ‘ãƒ¯ãƒ¼å¸¯ã®éƒ¨å“¡ãŒå„ã€…å¥½ããªéŠã³æ–¹ã§æ¥½ã—ã‚“ã§ã„ã¾ã™ï¼<br>ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹é–¢ä¿‚ãªãã‚ªãƒ³ã§ã‚ã„ã‚ã„ã‚„ã£ã¦ã¾ã™ï¼<br>ä»–å¤§å­¦ã•ã‚“ã¨ã®äº¤æµã«ã‚‚èˆˆå‘³ã‚ã‚Šã¾ã™ğŸ˜"
            },
            {
                "circle-university": "é›»æ°—é€šä¿¡å¤§å­¦", "circle-name": "squec",
                "circle-social-img": "https://pbs.twimg.com/profile_images/1847300499848187904/rbB4Ay48_400x400.jpg",
                "circle-social-id": "UECSplatoon", "circle-social-win": "squecWIN",
                "circle-comment": "ã‚ªãƒ³ã‚ªãƒ•å•ã‚ãšå¤šå½©ãªå¤§ä¼šã‚’é–‹å‚¬ã—ã€å­¦éƒ¨ç”Ÿã‹ã‚‰é™¢ç”Ÿã¾ã§å¹´é½¢ã«é–¢ã‚ã‚‰ãšä»²è‰¯ãã‚¹ãƒ—ãƒ©ãƒˆã‚¥ãƒ¼ãƒ³ã‚’ã—ã¦ã„ã¾ã™ğŸ¶"
            },
            {
                "circle-university": "ç­‘æ³¢å¤§å­¦", "circle-name": "Tsuquid",
                "circle-social-img": "https://pbs.twimg.com/profile_images/1567846700299202563/h3goVWH5_400x400.jpg",
                "circle-social-id": "splatoon_itf_ut", "circle-social-win": "ã¤ãã„ã£ã©WIN",
                "circle-comment": "ã‚¬ãƒã§ã‚‚ã‚¨ãƒ³ã‚¸ãƒ§ã‚¤ã§ã‚‚å¤§æ­“è¿â€¼ï¸ã‚µãƒ¼ã‚¯ãƒ«å†…å¤§ä¼šã‚„ã‚ªãƒ•ä¼šãªã©ã‚¤ãƒ™ãƒ³ãƒˆã‚‚ç››ã‚Šã ãã•ã‚“â€¼ï¸<br>OBãƒ»OGå«ã‚å­¦å¹´å•ã‚ãšã¿ã‚“ãªã§æ¥½ã—ãæ´»å‹•ã—ã¦ã„ã¾ã™â€¼ï¸ğŸ¦‘âœ¨"
            },
            {
                "circle-university": "æ…¶æ‡‰ç¾©å¡¾å¤§å­¦", "circle-name": "æ…¶æ‡‰ã‚¹ãƒ—ãƒ©åŒå¥½ä¼š",
                "circle-social-img": "https://pbs.twimg.com/profile_images/1634460254842015750/a1NpOHTV_400x400.jpg",
                "circle-social-id": "keiospla", "circle-social-win": "æ…¶ã‚¹ãƒ—WIN",
                "circle-comment": "ã‚¬ãƒå‹¢ã‚‚ã‚¨ãƒ³ã‚¸ãƒ§ã‚¤å‹¢ã‚‚ã¿ã‚“ãªä»²è‰¯ãæ¥½ã—ãã‚„ã£ã¦ã¾ã™â™ª<br>ä»–å¤§å­¦ã¨ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚„äº¤æµã‚‚æ´»ç™ºã§ã™ï¼"
            }
        ];

        const TEAMS_DATA = [
            {
                "id": "team_001", "teamName": "ãƒ•ãƒ­ã‚²ãƒ¼ãƒãƒ¼", "teamName_kana": "----",
                "university": "æ¨ªæµœå›½ç«‹å¤§å­¦", "circle": "æµœã‚¤ã‚«",
                "comment": "å®Ÿç¸¾ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€é¢¨å‘‚ã‹ã‚‰ã®ãƒ—ãƒ¬ã‚¤ãŒæœ€å¼·ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦çˆªç—•ã‚’æ®‹ã›ã‚‹ã‚ˆã†ã«é ‘å¼µã‚Šã¾ã™ï¼ï¼ç·¨æˆã«çµ„ã¿è¾¼ã‚€æ­¦å™¨åŒå£«ã®ã‚·ãƒŠã‚¸ãƒ¼ã‚’æ´»ã‹ã—ã¦ãƒãƒ¼ãƒ æˆ¦ã‚’åˆ¶ã—ã¾ã™ï¼",
                "records": "----", "message": "ã“ã®å¤§ä¼šã®ã¿ã®ãƒãƒ¼ãƒ ã§ã¯ã‚ã‚‹ã‚‚ã®ã®ãƒãƒ¼ãƒ ä»²ãŒã¨ã¦ã‚‚ã‚ˆãã€ç·´ç¿’ã®å¯¾æŠ—æˆ¦ã‚‚æ¥½ã—ãã†ã«ã‚„ã£ã¦ã„ã‚‹ã®ã§ã€ãœã²å„ªå‹ã—ã¦ã»ã—ã„ã§ã™ï¼",
                "p1_name": "ãã˜", "p1_name_kana": "----", "p1_weapon": "ãƒã‚±ãƒƒãƒˆã‚¹ãƒ­ãƒƒã‚·ãƒ£ãƒ¼ã€ãƒãƒ´ã‚¡ãƒ–ãƒ©ã‚¹ã‚¿ãƒ¼ãƒã‚ªã€ã‚¤ã‚°ã‚¶ãƒŸãƒŠãƒ¼",
                "p2_name": "ã‚†ã¥", "p2_name_kana": "----", "p2_weapon": "ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ¯ã‚¤ãƒ‘ãƒ¼ã€R-PEN/5Hã€Rãƒ–ãƒ©ã‚¹ã‚¿ãƒ¼ã‚¨ãƒªãƒ¼ãƒˆWNTR",
                "p3_name": "283", "p3_name_kana": "ã¤ã°ã•", "p3_weapon": "ãƒã‚±ãƒƒãƒˆã‚¹ãƒ­ãƒƒã‚·ãƒ£ãƒ¼ã€ãƒ’ãƒƒã‚»ãƒ³ãƒ’ãƒ¥ãƒ¼ã€R-PEN/5H",
                "p4_name": "ã‚³ã£ãƒš", "p4_name_kana": "----", "p4_weapon": "ã‚·ãƒ£ãƒ¼ãƒ—ãƒãƒ¼ã‚«ãƒ¼ã€ãƒ—ãƒ©ã‚¤ãƒ ã‚·ãƒ¥ãƒ¼ã‚¿ãƒ¼ã€N-ZAP85",
                "team_average_xp": "2878"
            },
            {
                "id": "team_002", "teamName": "ã‚¹ã‚¿ãƒ¼ãƒŸãƒ¼ã€ç«‹ã¤ãª", "teamName_kana": "----",
                "university": "ç«‹å‘½é¤¨å¤§å­¦", "circle": "ãƒªãƒ„ãƒ¡ã‚¤ã‚«",
                "comment": "1å¹´ç”Ÿ3äººã®æˆé•·ã‚’æ¥½ã—ã¿ã«ã—ãªãŒã‚‰ã‚‚ã€ã‚µãƒ¼ã‚¯ãƒ«ã®åã‚’èƒŒè² ã£ã¦ã„ã‚‹ã®ã§é ‘å¼µã‚ŠãŸã„ã§ã™ã€‚",
                "records": "----", "message": "æœ€è¿‘ã®ãƒªãƒ„ãƒ¡ã‚¤ã‚«ã¯ä¸€åº¦ã®é€šè©±ã«24äººã‚‚é›†ã¾ã‚‹ã»ã©ã®ç››ã‚Šä¸ŠãŒã‚Šï¼<br>ãã‚“ãªä¸­ã§é–‹å‚¬ã•ã‚Œã‚‹ã€Œå¤§å­¦æ¯ çœŸæ‰“ã€ã§ã¯ã€ãƒªãƒ„ãƒ¡ã‚¤ã‚«ãŒã•ã‚‰ã«ç†±æ°—ã‚’å¸¯ã³ã‚‹ã“ã¨é–“é•ã„ãªã—ğŸ”¥<br>ä»Šå›å‡ºå ´ã™ã‚‹ã®ã¯ã€åœ§å€’çš„ãªç«‹ã¡å›ã‚Šã¨ã‚­ãƒ«ã§é­…ã›ã‚‹å‰ç·šä½¿ã„ã®ãã‚ã€å†·é™ãªåˆ¤æ–­ã§ãƒãƒ¼ãƒ ã‚’æ”¯ãˆã‚‹ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚‚ãã€<br>ãã—ã¦ã‚¹ãƒ—ãƒ©ãƒˆã‚¥ãƒ¼ãƒ³ã§åˆã‚ã¦ã®å¤§ä¼šã«æŒ‘ã‚€ãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãªã¼ã¦ã‡ã¼ã‰ã®æœŸå¾…ã®1å›ç”ŸãŸã¡ã€ã•ã‚‰ã«å®‰å®šæ„ŸæŠœç¾¤ã§èƒŒä¸­ã‚’ä»»ã›ã‚‰ã‚Œã‚‹2å›ç”Ÿãƒšãƒ³ä½¿ã„ã‚¯ãƒãƒãƒŸã®4äººãƒãƒ¼ãƒ ï¼<br>å‹¢ã„ãƒ»çŸ¥ç•¥ãƒ»æŒ‘æˆ¦ãƒ»ä¿¡é ¼ãŒãã‚ã£ãŸã“ã®ãƒ¡ãƒ³ãƒãƒ¼ãªã‚‰ã€ãã£ã¨ãƒªãƒ„ãƒ¡ã‚¤ã‚«ã‚’ã•ã‚‰ã«ç››ã‚Šä¸Šã’ã¦ãã‚Œã‚‹ã¯ãšï¼<br>ãŸãã•ã‚“æš´ã‚Œã¦ãŠã„ã§ã€œï¼ï¼",
                "p1_name": "ã‚¯ãƒãƒãƒŸ", "p1_name_kana": "----", "p1_weapon": "R-PEN5Hã€ãƒªãƒƒã‚¿ãƒ¼4K",
                "p2_name": "soloâ™ª", "p2_name_kana": "----", "p2_weapon": "ã‚·ãƒ£ãƒ¼ãƒ—ãƒãƒ¼ã‚«ãƒ¼ã€ã‚¹ãƒ—ãƒ©ã‚·ãƒ¥ãƒ¼ã‚¿ãƒ¼ã€ã‚¸ã‚§ãƒƒãƒˆã‚¹ã‚¤ãƒ¼ãƒ‘ãƒ¼ã‚³ãƒ–ãƒ©",
                "p3_name": "ã‚‚ã", "p3_name_kana": "----", "p3_weapon": "ã‚¹ãƒ—ãƒ©ãƒãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ã€Rãƒ–ãƒ©ã‚¹ã‚¿ãƒ¼ã‚¨ãƒªãƒ¼ãƒˆãƒ‡ã‚³",
                "p4_name": "ã¼ã¦ã‡ã¼ã‰", "p4_name_kana": "----", "p4_weapon": "ãƒ´ã‚¡ãƒªã‚¢ãƒ–ãƒ«ãƒ­ãƒ¼ãƒ©ãƒ¼ã€ãƒ•ã‚£ãƒ³ã‚»ãƒ³ãƒˆã€ã‚¹ãƒ—ãƒ©ãƒ­ãƒ¼ãƒ©ãƒ¼",
                "team_average_xp": "2898"
            },
            {
                "id": "team_003", "teamName": "ç„¡è¦–ã™ã‚“ãªããããã", "teamName_kana": "----",
                "university": "å¤§é˜ªå…¬ç«‹å¤§å­¦", "circle": "OMUã‚¹ãƒ—ãƒ©éƒ¨",
                "comment": "æœ€å¼·ã®ãƒ¡ãƒ³ãƒ„ã§ä»Šå›ã“ãã¯å„ªå‹ã—ã¾ã™ï¼",
                "records": "ç¬¬å…«å›å¤§å­¦æ¯+å„ªå‹(é¸æ‰‹1,2,4)", "message": "æœ€å¾Œã¾ã§ç«‹ã£ã¦ã‚‹ã®ã¯ã“ã®4äººã§ã™ã€‚<br>å…¨å“¡è–™ãå€’ã—ã¦ãã¦ãã ã•ã„ğŸ“£",
                "p1_name": "ãƒ’ãƒ­ãƒˆX", "p1_name_kana": "----", "p1_weapon": "ãƒ­ãƒ³ã‚°ãƒ–ãƒ©ã‚¹ã‚¿ãƒ¼ã€ãƒ­ãƒ³ã‚°ãƒ–ãƒ©ã‚¹ã‚¿ãƒ¼ã‚«ã‚¹ã‚¿ãƒ ",
                "p2_name": "ã•ã„ã¼ã†", "p2_name_kana": "----", "p2_weapon": "Rãƒšãƒ³ã€ã‚±ãƒ«ãƒ“ãƒ³",
                "p3_name": "ãã‚‹ã¨", "p3_name_kana": "----", "p3_weapon": "ãƒã‚±ãƒ„",
                "p4_name": "22", "p4_name_kana": "----", "p4_weapon": "ã‚¹ãƒ”ã‚³ãƒ©ã€ã‚·ãƒ£ã‚«",
                "team_average_xp": "3266"
            },
            {
                "id": "team_004", "teamName": "åã™ã¨ã‚ã‚“ãå", "teamName_kana": "ã¾ã‚“ã˜ã™ã¨ã‚ã‚“ãã¾ã‚“ã˜",
                "university": "æ˜æ²»è–¬ç§‘å¤§å­¦", "circle": "ã‚¹ãƒ—ãƒ©ãƒˆã‚¥ãƒ¼ãƒ³éƒ¨",
                "comment": "ãƒ“ãƒ¼ã‚³ãƒ³ä½¿ã£ã¦æš´ã‚Œã¾ã™ï¼",
                "records": "----", "message": "éƒ¨å“¡ã¿ã‚“ãªã§å¿œæ´ã—ã¦ã¾ã™é ‘å¼µã£ã¦ãã ã•ã„ï¼ï¼ï¼",
                "p1_name": "ãŸãƒ¼ã¡ã‚ƒã‚“â€¼ï¸", "p1_name_kana": "----", "p1_weapon": "52ã‚¬ãƒ­ãƒ³",
                "p2_name": "ãƒãƒ«ãƒã‚¢ã‚µãƒ³ã¤ã¹", "p2_name_kana": "----", "p2_weapon": "ãƒ›ã‚¯ã‚µã‚¤ãƒ’ãƒ¥ãƒ¼",
                "p3_name": "ã‚„ãƒ¼ã¡ã‚ƒã‚“â€¼ï¸", "p3_name_kana": "----", "p3_weapon": "ã‚¹ãƒ—ãƒ©ã‚·ãƒ¥ãƒ¼ã‚¿ãƒ¼ç…Œ",
                "p4_name": "ãˆãŸãƒ¼ãªã‚‹", "p4_name_kana": "----", "p4_weapon": "ã‚·ãƒ£ãƒ¼ãƒ—ãƒãƒ¼ã‚«ãƒ¼",
                "team_average_xp": "2477"
            },
            {
                "id": "team_005", "teamName": "æœ€çµ‚é˜²è¡›ç·šç‰™ç’ƒç‹", "teamName_kana": "ã•ã„ã—ã‚…ã†ã¼ã†ãˆã„ã‚‰ã„ã‚“ãŒã‚ŠãŠã†",
                "university": "é–¢è¥¿å¤§å­¦", "circle": "é–¢å¤§ã‚¹ãƒ—ãƒ©",
                "comment": "å¼Šã‚µãƒ¼ã‚¯ãƒ«ãƒ¡ãƒ³ãƒãƒ¼ã®TOP4ãŒåˆã‚ã¦é›†çµã—ãŸã®ã§å„ªå‹ã•ã›ã¦é ‚ãã¾ã™ğŸ†",
                "records": "----", "message": "----",
                "p1_name": "ã¦ãƒãƒ¼ã‚‰", "p1_name_kana": "----", "p1_weapon": "ãƒ­ãƒ³ã‚°ãƒ–ãƒ©ã‚¹ã‚¿ãƒ¼ã€ã‚¨ãƒªãƒ‡ã‚³",
                "p2_name": "mima", "p2_name_kana": "----", "p2_weapon": "ãƒ‘ãƒ–ãƒ­ãƒ’ãƒ¥ãƒ¼",
                "p3_name": "ãŒã‚ŠãŠ", "p3_name_kana": "----", "p3_weapon": "R-PEN5/Hã€ãƒªãƒƒã‚¿ãƒ¼4k",
                "p4_name": "ã¾ã—ã‚", "p4_name_kana": "----", "p4_weapon": "ã‚¯ã‚¢ãƒƒãƒ‰ã€ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ¯ã‚¤ãƒ‘ãƒ¼",
                "team_average_xp": "2953"
            },
            {
                "id": "team_006", "teamName": "squec", "teamName_kana": "ã‚¹ã‚¯ã‚¨ãƒƒã‚¯",
                "university": "é›»æ°—é€šä¿¡å¤§å­¦", "circle": "squec",
                "comment": "çŸ¥ååº¦ä¸‹ã‹ã‚‰1ç•ªå¤§å­¦ã€1ç•ªä¸Šã«ãªã‚ŠãŸã„ã§ã™ï¼ï¼ï¼ï¼ï¼",
                "records": "å¤šåˆ†ãªã„ã‚ˆ", "message": "(é™¢ç”Ÿã‚’é™¤ã„ãŸã‚‰)squecã§4äººã—ã‹ã„ãªã„Xp3000è¶…ãˆã‚’é›†ã‚ãŸæœ€å¼·ãƒãƒ¼ãƒ ï¼ squecä»£è¡¨ã®é¡”ã¤ãã§å„ªå‹ã—ã¦ãã‚Œã€œã€œã€œã€œã€œ",
                "p1_name": "ã‚†ãã†ã•ã", "p1_name_kana": "----", "p1_weapon": "Rpen5H, ã‚¹ãƒ—ãƒ©ã‚·ãƒ¥ãƒ¼ã‚¿ãƒ¼, Nzap85",
                "p2_name": "ã¾ããã£ã©", "p2_name_kana": "----", "p2_weapon": "ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ¯ã‚¤ãƒ‘ãƒ¼, ã‚·ãƒ£ãƒ¼ãƒ—ãƒãƒ¼ã‚«ãƒ¼, ã‚·ãƒ£ãƒ¼ãƒ—ãƒãƒ¼ã‚«ãƒ¼ãƒã‚ª",
                "p3_name": "ãƒ¤ãƒãƒˆ", "p3_name_kana": "----", "p3_weapon": "ã‚¹ãƒ—ãƒ©ã‚·ãƒ¥ãƒ¼ã‚¿ãƒ¼, ã‚·ãƒ£ãƒ¼ãƒ—ãƒãƒ¼ã‚«ãƒ¼, ãƒã‚±ãƒƒãƒˆã‚¹ãƒ­ãƒƒã‚·ãƒ£ãƒ¼",
                "p4_name": "ã‚³ãƒ¼ãƒ³", "p4_name_kana": "----", "p4_weapon": "S-blast91, ãƒ­ãƒ³ã‚°ãƒ–ãƒ©ã‚¹ã‚¿ãƒ¼, ãƒ­ãƒ³ã‚°ãƒ–ãƒ©ã‚¹ã‚¿ãƒ¼ã‚«ã‚¹ã‚¿ãƒ ",
                "team_average_xp": "3045"
            },
            {
                "id": "team_007", "teamName": "Unlimited ITF.", "teamName_kana": "----",
                "university": "ç­‘æ³¢å¤§å­¦", "circle": "Tsuquid",
                "comment": "å¤äº•æˆ¸ã‚„ã€€ã‚¤ã‚«ãŒé£›ã³è¾¼ã‚€ã€€ãƒãƒ³ãƒ¡ãƒ³ãƒŸğŸ¦‘",
                "records": "----", "message": "Tsuquidã®å‹åˆ©ã‚’IMAGINE THE FUTURE. <br>Tsuquidè‡ªæ…¢ã®ç²¾é‹­ãŸã¡ãŒå€‹æ€§çš„ãªãƒ¡ãƒ³ãƒãƒ¼ã¨ãƒ–ã‚­ã§å¤§æ´»èºé–“é•ã„ãªã—ï¼ï¼<br>å¤§å­¦æ¯çœŸæ‰“ã®æœªæ¥ã‚’å¡—ã‚Šæ›¿ãˆã‚‹ã®ã¯ã“ã®ãƒãƒ¼ãƒ ã§ã™ï¼<br>by ã‚µãƒ¼ã‚¯ãƒ«ä»£è¡¨ã€€ãŸã¹",
                "p1_name": "ã›ã‚Šãƒ¼ã¬", "p1_name_kana": "----", "p1_weapon": "ãƒã‚¤ãƒ‰ãƒ©ãƒ³ãƒˆåœ§ã€ãƒã‚¤ãƒ‰ãƒ©ãƒ³ãƒˆã€ãƒã‚¤ãƒ‰ãƒ©ãƒ³ãƒˆã‚«ã‚¹ã‚¿ãƒ ",
                "p2_name": "ã®ã£ã¡", "p2_name_kana": "----", "p2_weapon": "ãƒãƒ´ã‚¡ãƒ–ãƒ©ã‚¹ã‚¿ãƒ¼ãƒã‚ª",
                "p3_name": "ysk", "p3_name_kana": "----", "p3_weapon": "R-PEN/5Hã€ã‚¯ãƒ¼ã‚²ãƒ«ã‚·ãƒ¥ãƒ©ã‚¤ãƒãƒ¼ã€ã‚·ãƒ£ãƒ¼ãƒ—ãƒãƒ¼ã‚«ãƒ¼",
                "p4_name": "ãƒ¡ã‚¬ãƒ", "p4_name_kana": "----", "p4_weapon": "ã‚¹ãƒ‘ã‚¤ã‚¬ã‚¸ã‚§ãƒƒãƒˆ",
                "team_average_xp": "2926"
            },
            {
                "id": "team_008", "teamName": "RMpaches", "teamName_kana": "----",
                "university": "æ…¶æ‡‰ç¾©å¡¾å¤§å­¦", "circle": "æ…¶æ‡‰ã‚¹ãƒ—ãƒ©åŒå¥½ä¼š",
                "comment": "å®Ÿç¸¾ã¯ã‚¹ãƒ—ã‚´ãƒ¼å…¨æ•—ã§ã™ã€‚æ„æ°—è¾¼ã¿ã¯ã‚¨ãƒªã‚¢ã‚’ã‚µãƒ¡ãƒ©ã‚¤ãƒ‰ã§å–ã£ãŸã‚‹ã§ã€œï¼æˆ¦ç•¥ã¯ãƒ¢ãƒƒãƒ—ãƒªãƒ³ã¨é‰›ç­†ã§ãƒ©ã‚¤ãƒ³ç¶­æŒã—ã¦52ã‚¬ãƒ­ãƒ³ã¨ã‚¹ã‚¯ã‚¹ãƒ­ãŒè‡ªç”±ã«å‹•ãã¾ã™ã€‚52ã‚¬ãƒ­ãƒ³ã®è¯éº—ãªã‚¹ãƒ†ãƒƒãƒ—ã«æ³¨ç›®ï¼ã§ã™ã€‚å˜˜ã§ã™ãªã‚“ã§ã‚‚ã„ã„ã§ã™ã€‚",
                "records": "ã‚¹ãƒ—ã‚´ãƒ¼å…¨æ•—", "message": "ãŠäº’ã„ã‚’ã‚ˆãç†è§£ã—ã¦ã„ã¦æŠœç¾¤ã®ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ãƒãƒ¼ãƒ ã®ä»²ã®è‰¯ã•ã‚‚1ç•ªã§ã™ï¼",
                "p1_name": "ã¬ã¡", "p1_name_kana": "----", "p1_weapon": "ãƒ•ã‚£ãƒ³ã‚»ãƒ³ãƒˆ",
                "p2_name": "ã‚ˆã£ã—ãƒ¼", "p2_name_kana": "----", "p2_weapon": "ãƒ¢ãƒƒãƒ—ãƒªãƒ³è§’",
                "p3_name": "ã‚¸ãƒ§ãƒ³ã‚½ãƒ³", "p3_name_kana": "----", "p3_weapon": "é‰›ç­†",
                "p4_name": "ã‚ã‚Šã™ã‚‚ã‹", "p4_name_kana": "----", "p4_weapon": "52ã‚¬ãƒ­ãƒ³",
                "team_average_xp": "3048"
            },
            {
                "id": "team_009", "teamName": "èŠ‹ç…®ä¼š", "teamName_kana": "----",
                "university": "ä¹å·å·¥æ¥­å¤§å­¦", "circle": "QTSSã‚¹ãƒ—ãƒ©éƒ¨é–€",
                "comment": "ãƒãƒ«ã„èŠ‹ç…®ä¼šã‚’ç›®æŒ‡ã—ã¦é ‘å¼µã‚Šã¾ã™",
                "records": "----", "message": "QTSSã®æœ€å¼·ã‚’é›†ã‚ã¾ã—ãŸ è¨­ç«‹ã‹ã‚‰ã¾ã è‹¥ã„ã§ã™ãŒã¶ã¡ã‹ã¾ã—ã¦ã‚‚ã‚‰ã„ã¾ã™ï¼",
                "p1_name": "Tago", "p1_name_kana": "----", "p1_weapon": "ãƒ—ãƒ©ã‚¤ãƒ ã‚·ãƒ¥ãƒ¼ã‚¿ãƒ¼",
                "p2_name": "ã‚Œãƒ¼ã‚‹", "p2_name_kana": "----", "p2_weapon": "ã‚·ãƒ£ãƒ¼ãƒ—ãƒãƒ¼ã‚«ãƒ¼",
                "p3_name": "ã˜ã‚ƒãŒã„ã‚‚", "p3_name_kana": "----", "p3_weapon": "R-PEN/5H",
                "p4_name": "ã½ã¦ã¨ã‚“", "p4_name_kana": "----", "p4_weapon": "ãƒ‡ãƒ¥ã‚¢ãƒ«ã‚¹ã‚¤ãƒ¼ãƒ‘ãƒ¼",
                "team_average_xp": "2908"
            },
            {
                "id": "team_010", "teamName": "å…¬å®¶æµãƒ•ã‚«ãƒ’ãƒ¬ã‚¹ãƒ¼ãƒ—", "teamName_kana": "----",
                "university": "æ±äº¬é›»æ©Ÿå¤§å­¦", "circle": "æ±äº¬é›»æ©Ÿå¤§å­¦e-sportséƒ¨ ã‚¹ãƒ—ãƒ©éƒ¨é–€",
                "comment": "ãƒ‡ãƒ³ã‚¿ãƒ«æ‰“é–‹é ‘å¼µã‚Šã¾ã™",
                "records": "----", "message": "----",
                "p1_name": "ã—ã‚ƒãƒ¼ã", "p1_name_kana": "----", "p1_weapon": "èµ¤ãƒšãƒ³ã€é’ãƒšãƒ³ã€ãƒ‡ãƒ³ã‚¿ãƒ«ãƒŸãƒ³ãƒˆ",
                "p2_name": "ãƒªã‚¯ãƒ¼ã‚²ãƒ«", "p2_name_kana": "----", "p2_weapon": "ã‚¯ãƒ¼ã‚²ãƒ«ã€ã‚¶ãƒŸãƒŠãƒ¼ã€ãƒãƒ¬ãƒ«",
                "p3_name": "ã¿ã¨", "p3_name_kana": "----", "p3_weapon": "ã‚¯ãƒ©ãƒ–ãƒ©ã€sãƒ–ãƒ©ã€ãƒ›ãƒƒã‚«ã‚¹",
                "p4_name": "ã¡ã‚…ã†ã‹", "p4_name_kana": "----", "p4_weapon": "ãƒˆãƒ©ã‚¹ãƒˆã€ãƒˆãƒ©ã‚³ãƒ©ã€è™¹å¼“",
                "team_average_xp": "2736"
            }
        ];

        // --- Firebase Init ---
        const firebaseConfig = {
            apiKey: "AIzaSyDkyt4nQBcO1KsigXQ6sKzC5iKMWg_GeW0",
            authDomain: "daigakuhai-support-fb.firebaseapp.com",
            projectId: "daigakuhai-support-fb",
            storageBucket: "daigakuhai-support-fb.firebasestorage.app",
            messagingSenderId: "939931798179",
            appId: "1:939931798179:web:8320fba89104e81f47cd16"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const tournamentRef = doc(db, "state", "tournament");
        const settingsRef = doc(db, "state", "settings");

        // --- Variables ---
        let teamsData = TEAMS_DATA.map(t => ({ id: t.id, name: t.teamName }));
        if (!teamsData.some(t => t.id === "THE_SEED")) {
            teamsData.unshift({ id: "THE_SEED", name: "ã‚·ãƒ¼ãƒ‰/æ£„æ¨©" }); 
        }

        let currentFormat = 8;
        let tournamentData = { format: 8, matches: {}, roundNames: {} };
        let tournamentSettings = {
            matchFormat: { other: 'BO3', semis: 'BO5', finals: 'BO5' },
            tournamentName: "å¤§ä¼šåæœªè¨­å®š"
        };

        const bracketWrapper = document.getElementById('bracket-wrapper');
        const headerTitle = document.getElementById('header-title');

        // --- Main Init ---
        async function init() {
            setupFirestoreListener();
            setupDragScroll();
        }

        function setupDragScroll() {
            const slider = document.querySelector('.bracket-container');
            let isDown = false;
            let startX, scrollLeft, startY, scrollTop;

            slider.addEventListener('mousedown', (e) => {
                isDown = true;
                slider.classList.add('active');
                startX = e.pageX - slider.offsetLeft;
                scrollLeft = slider.scrollLeft;
                startY = e.pageY - slider.offsetTop;
                scrollTop = slider.scrollTop;
            });
            slider.addEventListener('mouseleave', () => { isDown = false; slider.classList.remove('active'); });
            slider.addEventListener('mouseup', () => { isDown = false; slider.classList.remove('active'); });
            slider.addEventListener('mousemove', (e) => {
                if (!isDown) return;
                e.preventDefault();
                const x = e.pageX - slider.offsetLeft;
                const y = e.pageY - slider.offsetTop;
                slider.scrollLeft = scrollLeft - (x - startX);
                slider.scrollTop = scrollTop - (y - startY);
            });
        }

        // --- Firestore ---
        function setupFirestoreListener() {
            onSnapshot(tournamentRef, (docSnap) => {
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    tournamentData = data;
                    if (!tournamentData.matches) tournamentData.matches = {};
                    if (!tournamentData.roundNames) tournamentData.roundNames = {};
                    if (tournamentData.format) {
                        currentFormat = parseInt(tournamentData.format);
                    }
                    renderBracket();
                }
            });

            onSnapshot(settingsRef, (docSnap) => {
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    if(data.tournamentName) {
                        headerTitle.textContent = `${data.tournamentName} ãƒˆãƒ¼ãƒŠãƒ¡ãƒ³ãƒˆè¡¨`;
                    }
                    if(data.matchFormat) {
                        tournamentSettings.matchFormat = data.matchFormat;
                        renderBracket();
                    }
                }
            });
        }

        function getRoundFormat(roundNum, totalRounds) {
            const settings = tournamentSettings.matchFormat || { other: 'BO3', semis: 'BO5', finals: 'BO5' };
            if (roundNum === totalRounds) return settings.finals;
            if (roundNum === totalRounds - 1) return settings.semis;
            return settings.other;
        }

        function getTeamName(id) {
            if (!id) return "æœªæ±ºå®š";
            if (id === "THE_SEED") return "ã‚·ãƒ¼ãƒ‰";
            const t = TEAMS_DATA.find(t => t.id === id);
            return t ? t.teamName : "ä¸æ˜ãªãƒãƒ¼ãƒ ";
        }

        // --- Rendering ---
        function renderBracket() {
            bracketWrapper.innerHTML = '';
            const totalRounds = Math.log2(currentFormat);
            
            for (let r = 1; r <= totalRounds; r++) {
                const roundCol = document.createElement('div');
                roundCol.className = 'round-column';
                
                const header = document.createElement('div');
                header.className = 'round-header';
                let defaultName = `ãƒ©ã‚¦ãƒ³ãƒ‰ ${r}`;
                if (r === totalRounds) defaultName = "æ±ºå‹";
                else if (r === totalRounds - 1) defaultName = "æº–æ±ºå‹";
                else if (r === totalRounds - 2 && totalRounds > 2) defaultName = "æº–ã€…æ±ºå‹";

                const displayName = tournamentData.roundNames && tournamentData.roundNames[r] ? tournamentData.roundNames[r] : defaultName;
                header.textContent = displayName;
                roundCol.appendChild(header);

                const matchCount = currentFormat / Math.pow(2, r);
                const boType = getRoundFormat(r, totalRounds);

                for (let m = 1; m <= matchCount; m++) {
                    const matchId = `r${r}_m${m}`;
                    const matchData = tournamentData.matches[matchId] || { alpha: null, bravo: null, scoreA: 0, scoreB: 0, winner: null, isLive: false };
                    
                    const alphaName = getTeamName(matchData.alpha);
                    const bravoName = getTeamName(matchData.bravo);
                    
                    const card = createMatchCard(matchId, matchData, alphaName, bravoName, boType);
                    roundCol.appendChild(card);
                }
                bracketWrapper.appendChild(roundCol);
            }
        }

        function createMatchCard(matchId, data, alphaName, bravoName, boType) {
            const hasTeams = !!data.alpha && !!data.bravo;
            const isFinished = !!data.winner;
            const isActiveContext = hasTeams && !isFinished;
            const statusClass = isActiveContext ? 'status-active' : 'status-inactive';

            const div = document.createElement('div');
            div.className = `match-card ${data.isLive ? `is-live ${statusClass}` : ''}`;
            
            const header = document.createElement('div');
            header.className = 'match-header';
            
            const headerLeft = document.createElement('div');
            headerLeft.className = 'header-left-group';

            const idBadge = document.createElement('span');
            idBadge.className = 'match-id';
            idBadge.textContent = matchId.toUpperCase().replace('_', '-');
            
            const boBadge = document.createElement('span');
            boBadge.className = 'bo-badge';
            boBadge.textContent = boType;

            headerLeft.appendChild(idBadge);
            headerLeft.appendChild(boBadge);
            header.appendChild(headerLeft);

            if (data.isLive) {
                const liveBadge = document.createElement('span');
                liveBadge.className = 'live-badge';
                const icon = isActiveContext ? 'sensors' : 'pause_circle';
                liveBadge.innerHTML = `<span class="material-symbols-rounded" style="font-size: 14px;">${icon}</span>ON AIR`;
                header.appendChild(liveBadge);
            }

            div.appendChild(header);

            div.appendChild(createTeamRow('alpha', data, alphaName, data.alpha));
            div.appendChild(createTeamRow('bravo', data, bravoName, data.bravo));

            return div;
        }

        function createTeamRow(side, data, nameDisplay, teamId) {
            const row = document.createElement('div');
            const isWinner = data.winner === side;
            const isLoser = data.winner && data.winner !== side;
            
            row.className = `team-row ${isWinner ? 'winner' : (isLoser ? 'loser' : '')}`;
            
            const labelClass = side === 'alpha' ? 'label-alpha' : 'label-bravo';
            const score = side === 'alpha' ? data.scoreA : data.scoreB;

            let contentHTML = `<div class="team-label ${labelClass}"></div>`;
            
            const undecidedClass = nameDisplay === "æœªæ±ºå®š" ? "text-undecided" : "";
            
            let nameHTML = "";
            if(teamId && teamId !== "THE_SEED" && nameDisplay !== "æœªæ±ºå®š") {
                nameHTML = `<div class="team-name-display" title="ã‚¯ãƒªãƒƒã‚¯ã—ã¦è©³ç´°" onclick="openTeamModal('${teamId}')">${nameDisplay}</div>`;
            } else {
                nameHTML = `<div class="team-name-display ${undecidedClass}">${nameDisplay}</div>`;
            }

            contentHTML += `
                <div class="team-info-area">
                    ${nameHTML}
                </div>
            `;

            contentHTML += `<div class="score-display">${score}</div>`;
            
            contentHTML += `
                <div class="win-mark">
                    <span class="material-symbols-rounded" style="font-size: 20px;">emoji_events</span>
                </div>
            `;

            row.innerHTML = contentHTML;
            return row;
        }

        // --- Modal Logic (Teams) ---
        window.openTeamModal = (teamId) => {
            const team = TEAMS_DATA.find(t => t.id === teamId);
            if(!team) return;

            document.getElementById('m-name').textContent = team.teamName;
            
            // Team Kana Logic (Remove space if empty)
            const nameKanaEl = document.getElementById('m-name-kana');
            if (team.teamName_kana && team.teamName_kana !== "----") {
                nameKanaEl.textContent = team.teamName_kana;
                nameKanaEl.classList.remove('hidden');
            } else {
                nameKanaEl.textContent = "";
                nameKanaEl.classList.add('hidden');
            }

            document.getElementById('m-univ').textContent = team.university;
            
            // Circle Tag Logic
            const circleContainer = document.getElementById('m-circle-container');
            const circleNameEl = document.getElementById('m-circle');
            const circleIndicator = document.getElementById('m-circle-indicator');
            
            circleNameEl.textContent = team.circle;
            
            const hasCircleInfo = CIRCLE_DATA.some(c => c['circle-name'] === team.circle);
            if (hasCircleInfo) {
                circleContainer.classList.add('has-link');
                circleContainer.onclick = () => openCircleModal(team.circle);
                circleContainer.title = "ã‚µãƒ¼ã‚¯ãƒ«æƒ…å ±ã‚’è¡¨ç¤º";
                circleIndicator.classList.remove('hidden');
            } else {
                circleContainer.classList.remove('has-link');
                circleContainer.onclick = null;
                circleContainer.title = "";
                circleIndicator.classList.add('hidden');
            }

            document.getElementById('m-xp').textContent = `å¹³å‡XP ${team.team_average_xp}`;
            document.getElementById('m-comment').innerHTML = team.comment || "ã‚³ãƒ¡ãƒ³ãƒˆãªã—";
            document.getElementById('m-message').innerHTML = team.message || "----";
            document.getElementById('m-records').innerHTML = team.records || "ãªã—";

            const memContainer = document.getElementById('m-members');
            memContainer.innerHTML = '';
            for(let i=1; i<=4; i++) {
                const name = team[`p${i}_name`];
                const nameKana = team[`p${i}_name_kana`];
                const weaponStr = team[`p${i}_weapon`];
                
                if(name && name !== "----") {
                    const div = document.createElement('div');
                    div.className = 'member-list-item';
                    
                    // Create Kana HTML if exists
                    const kanaHtml = (nameKana && nameKana !== "----") 
                        ? `<span class="member-kana">${nameKana}</span>` 
                        : '';

                    // Split weapons into tags
                    let weaponsHtml = '';
                    if (weaponStr) {
                        const weapons = weaponStr.split(/[,ã€]/).map(w => w.trim()).filter(w => w);
                        weapons.forEach(w => {
                            weaponsHtml += `<span class="weapon-tag">${w}</span>`;
                        });
                    } else {
                        weaponsHtml = `<span class="weapon-tag text-gray-400">ãƒ–ã‚­æƒ…å ±ãªã—</span>`;
                    }

                    div.innerHTML = `
                        <div class="member-name-row">
                            <p class="member-name">
                                <span class="material-symbols-rounded text-base text-gray-400">person</span>
                                ${name}
                            </p>
                            ${kanaHtml}
                        </div>
                        <div class="weapon-container">
                            ${weaponsHtml}
                        </div>
                    `;
                    memContainer.appendChild(div);
                }
            }

            document.getElementById('team-modal').classList.add('show');
        };

        window.closeTeamModal = (e) => {
            if(e) e.stopPropagation();
            document.getElementById('team-modal').classList.remove('show');
        };

        // --- Modal Logic (Circles) ---
        window.openCircleModal = (circleName) => {
            const info = CIRCLE_DATA.find(c => c['circle-name'] === circleName);
            if (!info) return;

            document.getElementById('modal-c-img').src = info['circle-social-img'] || '';
            document.getElementById('modal-c-univ').textContent = info['circle-university'] || '';
            document.getElementById('modal-c-name').textContent = info['circle-name'] || '';
            
            const idEl = document.getElementById('modal-c-id');
            if (info['circle-social-id']) {
                idEl.textContent = `@${info['circle-social-id']}`;
                idEl.href = `https://twitter.com/${info['circle-social-id']}`;
                idEl.classList.remove('hidden');
            } else {
                idEl.classList.add('hidden');
            }

            document.getElementById('modal-c-win').textContent = info['circle-social-win'] ? `#${info['circle-social-win']}` : '';
            document.getElementById('modal-c-comment').innerHTML = info['circle-comment'] || '';

            document.getElementById('circle-modal').classList.add('show');
        };

        window.closeCircleModal = (e) => {
            if(e) e.stopPropagation();
            document.getElementById('circle-modal').classList.remove('show');
        };

        init();
    </script>
</body>
</html>